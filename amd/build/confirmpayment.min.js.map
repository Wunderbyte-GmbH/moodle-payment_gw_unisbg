{"version":3,"file":"confirmpayment.min.js","sources":["../src/confirmpayment.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * unisbg repository module to encapsulate all of the AJAX requests that can be sent for unisbg.\n *\n * @module     paygw_unisbg/confirmpayment\n * @copyright  2022 Georg Mai√üer <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\n\nexport const init = (itemid, customer, component, paymentarea, ischeckstatus, tid) => {\n\n    Ajax.call([{\n        methodname: \"paygw_unisbg_create_transaction_complete\",\n        args: {\n            component,\n            paymentarea,\n            itemid,\n            tid,\n            token: '',\n            customer,\n            ischeckstatus\n        },\n        done: function(data) {\n            if (data.success !== true) {\n                require(['jquery'], function($) {\n                    require(['core/str'], function(str) {\n                        var strings = [\n                            {\n                                key: 'error',\n                                component: 'paygw_unisbg'\n                            },\n                            {\n                                key: 'proceed',\n                                component: 'paygw_unisbg',\n                            }\n                        ];\n                        var localStrings = str.get_strings(strings);\n                        $.when(localStrings).done(function(localizedEditStrings) {\n                            ModalFactory.create({\n                                type: ModalFactory.types.CANCEL,\n                                title: localizedEditStrings[0],\n                                body: data.message,\n                                buttons: {\n                                    cancel: localizedEditStrings[1],\n                                },\n                            })\n                            .then(function(modal) {\n                                var root = modal.getRoot();\n                                root.on(ModalEvents.cancel, function() {\n                                    location.href = data.url;\n                                });\n                                modal.show();\n                                return true;\n                            }).catch({\n                                // Debugging console.log(e);\n                            });\n                        });\n                    });\n                });\n            } else {\n                location.href = data.url;\n            }\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"exxx:\" + ex);\n        },\n    }]);\n\n};"],"names":["Ajax","ModalFactory","ModalEvents"],"mappings":";;;;;;;;IAAA;AA0BA;AACY,UAAC,IAAI,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,KAAK;AACtF;IACA,IAAIA,wBAAI,CAAC,IAAI,CAAC,CAAC;IACf,QAAQ,UAAU,EAAE,0CAA0C;IAC9D,QAAQ,IAAI,EAAE;IACd,YAAY,SAAS;IACrB,YAAY,WAAW;IACvB,YAAY,MAAM;IAClB,YAAY,GAAG;IACf,YAAY,KAAK,EAAE,EAAE;IACrB,YAAY,QAAQ;IACpB,YAAY,aAAa;IACzB,SAAS;IACT,QAAQ,IAAI,EAAE,SAAS,IAAI,EAAE;IAC7B,YAAY,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,EAAE;IACvC,gBAAgB,OAAO,CAAC,CAAC,QAAQ,CAAC,EAAE,SAAS,CAAC,EAAE;IAChD,oBAAoB,OAAO,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,GAAG,EAAE;IACxD,wBAAwB,IAAI,OAAO,GAAG;IACtC,4BAA4B;IAC5B,gCAAgC,GAAG,EAAE,OAAO;IAC5C,gCAAgC,SAAS,EAAE,cAAc;IACzD,6BAA6B;IAC7B,4BAA4B;IAC5B,gCAAgC,GAAG,EAAE,SAAS;IAC9C,gCAAgC,SAAS,EAAE,cAAc;IACzD,6BAA6B;IAC7B,yBAAyB,CAAC;IAC1B,wBAAwB,IAAI,YAAY,GAAG,GAAG,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IACpE,wBAAwB,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,SAAS,oBAAoB,EAAE;IACjF,4BAA4BC,gCAAY,CAAC,MAAM,CAAC;IAChD,gCAAgC,IAAI,EAAEA,gCAAY,CAAC,KAAK,CAAC,MAAM;IAC/D,gCAAgC,KAAK,EAAE,oBAAoB,CAAC,CAAC,CAAC;IAC9D,gCAAgC,IAAI,EAAE,IAAI,CAAC,OAAO;IAClD,gCAAgC,OAAO,EAAE;IACzC,oCAAoC,MAAM,EAAE,oBAAoB,CAAC,CAAC,CAAC;IACnE,iCAAiC;IACjC,6BAA6B,CAAC;IAC9B,6BAA6B,IAAI,CAAC,SAAS,KAAK,EAAE;IAClD,gCAAgC,IAAI,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;IAC3D,gCAAgC,IAAI,CAAC,EAAE,CAACC,+BAAW,CAAC,MAAM,EAAE,WAAW;IACvE,oCAAoC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC;IAC7D,iCAAiC,CAAC,CAAC;IACnC,gCAAgC,KAAK,CAAC,IAAI,EAAE,CAAC;IAC7C,gCAAgC,OAAO,IAAI,CAAC;IAC5C,6BAA6B,CAAC,CAAC,KAAK,CAAC;IACrC;IACA,6BAA6B,CAAC,CAAC;IAC/B,yBAAyB,CAAC,CAAC;IAC3B,qBAAqB,CAAC,CAAC;IACvB,iBAAiB,CAAC,CAAC;IACnB,aAAa,MAAM;IACnB,gBAAgB,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC;IACzC,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,EAAE,SAAS,EAAE,EAAE;IAC3B;IACA,YAAY,OAAO,CAAC,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC;IACtC,SAAS;IACT,KAAK,CAAC,CAAC,CAAC;AACR;IACA;;;;;;;;;;"}